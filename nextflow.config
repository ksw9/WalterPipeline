
singularity {

    enabled                     = true

    envWhitelist                = "SLURM_CPUS_ON_NODE"

    runOptions                  = '-B "$TMPDIR"' // For compatibility with the parallel command called by Tb-Profiler

    autoMounts                  = true

}

process {

    container                   = "file:///scratch/ucgd/lustre/work/proj_UCGD/u1084359/20221026_Walter/kwalter_singularity.sif"

    withLabel: local {

    	executor		= "local"
        
        errorStrategy           = "retry"
        
        maxRetries              = 10

    }

    withLabel: slurm {

    	executor		= "slurm"

    	clusterOptions		= "-A ucgd-rw --partition ucgd-rw -N 1"
        
        errorStrategy           = "retry"
        
        maxRetries              = 10

    }

}

params {
    
    // Main files/directories
    // N.B. All paths are relative to resources_dir

    resources_dir               = "/scratch/ucgd/lustre/work/proj_UCGD/u1084359/20221026_Walter/resources"

    reads_list                  = "reads_list.tsv"

    kraken_database_path        = "kraken_db"

    reference_fasta_path        = "H37Rv.fa"

    reference_fasta_index_path  = "H37Rv.fa.fai"

    bwa_index_path              = "bwa_index"

    bowtie_index_path           = "bowtie2_index"

    bowtie_index_prefix         = "H37Rv"

    gatk_dictionary_path        = "gatk_dictionary/H37Rv.dict"

    bed_path                    = "H37Rv_ppe.bed.gz"

    bed_index_path              = "H37Rv_ppe.bed.gz.tbi"

    vcf_header                  = "ppe_hdr.txt"

    snpeff                      = "snpEff/snpEff.jar"

    snpeff_db                   = "Mycobacterium_tuberculosis_h37rv"

    snpeff_datapath             = "snpEff_refs"

    // Main variables

    mapper                      = "bwa"

    run_lofreq                  = false

    seq_platform                = "illumina"

    library                     = "library1"

    depth_threshold             = 5

    qual_threshold              = 20

    ploidy                      = 1

    nextseq                     = false

    nextseq_qual_threshold      = 20

}
